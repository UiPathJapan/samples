
## トランザクション アイテムを取得するアクティビティのサンプル ワークフロー

### Description

UiPath 2019.3 で改善された [トランザクション アイテムを取得 (Get Transaction Item)] アクティビティのサンプル ワークフローのご紹介です。

[トランザクション アイテムを取得 (Get Transaction Item)] アクティビティに [参照] プロパティが新たに実装され、トランザクション アイテムの参照でフィルタリングをすることが可能になりました。[フィルター ストラテジー] には [StartWith] と [Equals] の 2 つのオプションがあり、それぞれ以下のように使い分けます。

- [StartsWith] - 参照文字列の左端の文字セットがパターンとマッチするトランザクション アイテムのみを取得したい場合
- [Equals] - 参照文字列が完全一致するトランザクション アイテムのみを取得したい場合

本サンプルでは、まず Excel ファイルからトランザクション データを取得し、それらをキューに追加します。キューに追加する時には、キュー アイテムの参照として、Excel ファイルから取得したデータの「オーダー番号」列の値をセットします。「オーダー番号」は例として「Order201910150001」のように、Order と YYYYMMDD 形式の日付の文字列を結合したものをプリフィックスとして持ちます。

キュー アイテムを追加した後は [トランザクション アイテムを取得 (Get Transaction Item)] アクティビティを使い、トランザクション アイテムをキューから取り出します。この時、[フィルター ストラテジー] プロパティに StartWith、[参照] プロパティに文字列 Order20191015 をそれぞれセットします。これにより、トランザクション アイテムの参照が Order20191015 から始まるトランザクション アイテムのみをキューから取得することができます。

最後に、 [メッセージ ボックス] アクティビティを使い、取得したトランザクション アイテムの情報を出力した後、トランザクション ステータスを Successful に変更し、ワークフローが終了します。

### Note

サンプルのワークフローを実行するにあたって、以下の条件が事前に満たされている必要があります。

- ワークフローを実行するロボットが Orchestrator に接続されている
- Orchestrator のキューに、サンプルで使うキューが登録されている（サンプル内では SampleQueue という名前のキューを使っています）
- ワークフローを実行するロボットのロールに、キューの閲覧権限、トランザクションの閲覧・編集・作成権限が付与されている

### References

[[トランザクション アイテムを取得 (Get Transaction Item)] アクティビティガイド](https://docs.uipath.com/activities/lang-ja/docs/get-queue-item)